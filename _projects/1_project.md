---
layout: page
title: Medical Imaging
description: Identifying and localizing abnormalities on radiographs
img: assets/img/medical_imaging.png
importance: 1
category: work
---

Image classification is standard application of computer vision. Therefore it is natural to apply
these techniques to medical imaging. In the context of medicine it is typically not enough to know
a lesion in present, we would also like to know the location of the lesion. If the labels contain
locations, this can be used to train the model. In the case where the location is not included in the
label, there are a few options to infer the location, including gradient based class activation mapping
grad-CAM.

The idea behind grad-CAM is to use the derivative of the output associated with a specific class in the model with respect to the weights
in the final convolutional layer. This allows the model to localize regions in the image that are most impactful to the model predicting a certain class. The amazing thing is that this works without explicitly have bounding boxes or local labels for the lesions we are trying to detect.

Grad-CAM can also be used as a valuable tool to detect subtle forms of data leakage or other training issues. One example I found was early on in training the model on veterinary radiology images the model was performing very well on both the training and test sets. When I applied grad-CAM I noticed it was highlighting the corner of the image where on some of the images was a subtle watermark. I learned that this watermark was generated by the viewing software after the radiologist took a measurement (e.g. measuring the size of a pulmonary nodule). Therefore the model learned to look for whether or not the watermark was present. This leads to good model performance, but not for the right reason, and of course would not be useful in practice. The solution was to black out the corner of all images.

